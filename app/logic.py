from dataclasses import dataclass
from typing import Literal

from .content import image_links_for_set

# ===== Types =====
Skin = Literal["dry", "normal", "combo", "oily", "unknown"]
Tone = Literal["light", "medium", "tan"]
Undertone = Literal["warm", "cool", "unknown"]
Eyes = Literal["small", "big", "hooded", "almond"]
Occasion = Literal["daily", "date", "party", "photo"]
DetailLevel = Literal["short", "full"]


@dataclass
class Answers:
    skin: Skin
    tone: Tone
    undertone: Undertone
    eyes: Eyes
    occasion: Occasion


# ===== Photo sets =====
def pick_photo_set(a: Answers) -> int:
    if a.occasion == "date":
        return 2
    if a.occasion == "party":
        return 3
    if a.occasion == "photo":
        return 4

    if a.eyes == "hooded":
        return 5
    if a.eyes == "small":
        return 6

    if a.undertone == "warm":
        return 7
    if a.undertone == "cool":
        return 8

    if a.skin in ("oily", "combo"):
        return 9
    if a.skin == "dry":
        return 10

    return 1


# ===== Short lines =====
def skin_line(s: Skin) -> str:
    return {
        "dry": "—Å—É—Ö–∞—è ‚Üí —É–≤–ª–∞–∂–Ω–µ–Ω–∏–µ –∏ –∫—Ä–µ–º–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã",
        "normal": "–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è ‚Üí –ª—ë–≥–∫–∏–µ —Å–ª–æ–∏ –±–µ–∑ –ø–µ—Ä–µ–≥—Ä—É–∑–∞",
        "combo": "–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è ‚Üí –º–∞—Ç–∏—Ä—É–µ–º –¢-–∑–æ–Ω—É",
        "oily": "–∂–∏—Ä–Ω–∞—è ‚Üí —Ç–æ–Ω–∫–∏–π —Å–ª–æ–π + —Ñ–∏–∫—Å–∞—Ü–∏—è",
        "unknown": "—Ç–∏–ø –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω ‚Üí —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π –ø–æ–¥—Ö–æ–¥",
    }[s]


def undertone_line(u: Undertone) -> str:
    return {
        "warm": "—Ç—ë–ø–ª—ã–π ‚Üí –ø–µ—Ä—Å–∏–∫–æ–≤—ã–µ –∏ –±–µ–∂–µ–≤—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏",
        "cool": "—Ö–æ–ª–æ–¥–Ω—ã–π ‚Üí —Ä–æ–∑–æ–≤—ã–µ –∏ —Ö–æ–ª–æ–¥–Ω—ã–µ –±–µ–∂–∏",
        "unknown": "–Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω ‚Üí –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏",
    }[u]


def eyes_short(e: Eyes) -> str:
    return {
        "small": "–º–∞–ª–µ–Ω—å–∫–∏–µ ‚Üí —Å–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏, —Ç–µ–Ω—å —Ç–æ–ª—å–∫–æ —Å–Ω–∞—Ä—É–∂–∏",
        "big": "–±–æ–ª—å—à–∏–µ ‚Üí –¥–æ–±–∞–≤–ª—è–µ–º –≥–ª—É–±–∏–Ω—É –º—è–≥–∫–æ",
        "hooded": "–Ω–∞–≤–∏c—à–µ–µ –≤–µ–∫–æ ‚Üí —Ç–µ–Ω–∏ –≤—ã—à–µ —Å–∫–ª–∞–¥–∫–∏",
        "almond": "–º–∏–Ω–¥–∞–ª–µ–≤–∏–¥–Ω—ã–µ ‚Üí —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞",
    }[e]


# ===== Eyes full guides =====
def eyes_full(e: Eyes) -> str:
    if e == "small":
        return (
            "üëÅ **–ú–∞–ª–µ–Ω—å–∫–∏–µ –≥–ª–∞–∑–∞**\n"
            "‚Ä¢ –°–≤–µ—Ç–ª—ã–µ —Ç–µ–Ω–∏: –ø–æ–¥–≤–∏–∂–Ω–æ–µ –≤–µ–∫–æ + –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏–π —É–≥–æ–ª\n"
            "‚Ä¢ –ó–∞—Ç–µ–º–Ω–µ–Ω–∏–µ: —Ç–æ–ª—å–∫–æ –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª\n"
            "‚Ä¢ –§–æ—Ä–º–∞: –¥–∏–∞–≥–æ–Ω–∞–ª—å –≤–≤–µ—Ä—Ö (V)\n"
            "‚Ä¢ –¢—É—à—å: –≤—Ç–æ—Ä–æ–π —Å–ª–æ–π –≤–æ –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª\n"
            "‚ùå –ù–µ –∑–∞—Ç–µ–º–Ω—è–π –≤—Å—ë –≤–µ–∫–æ"
        )

    if e == "hooded":
        return (
            "üëÅ **–ù–∞–≤–∏—Å—à–µ–µ –≤–µ–∫–æ**\n"
            "‚Ä¢ –¢–µ–Ω–∏ —Ä–∏—Å—É–π –≤—ã—à–µ —Å–∫–ª–∞–¥–∫–∏\n"
            "‚Ä¢ –ú–∞—Ç–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã\n"
            "‚Ä¢ –†–∞—Å—Ç—É—à—ë–≤–∫–∞ –≤–≤–µ—Ä—Ö –∏ –Ω–∞—Ä—É–∂—É\n"
            "‚Ä¢ –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –ø–æ–¥–≤–æ–¥–∫–∞\n"
            "‚ùå –ù–µ —Ä–∏—Å—É–π —á—ë—Ç–∫—É—é –ª–∏–Ω–∏—é –ø–æ —Å–∫–ª–∞–¥–∫–µ"
        )

    if e == "big":
        return (
            "üëÅ **–ë–æ–ª—å—à–∏–µ –≥–ª–∞–∑–∞**\n"
            "‚Ä¢ –°–≤–µ—Ç–ª—ã–π –æ—Ç—Ç–µ–Ω–æ–∫ –Ω–∞ –≤–µ–∫–æ\n"
            "‚Ä¢ –°—Ä–µ–¥–Ω–∏–π ‚Äî –≤–æ –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª\n"
            "‚Ä¢ –ú—è–≥–∫–∞—è —Ä–∞—Å—Ç—É—à—ë–≤–∫–∞\n"
            "‚Ä¢ –ù–µ –ø–µ—Ä–µ–≥—Ä—É–∂–∞–π –Ω–∏–∂–Ω–µ–µ –≤–µ–∫–æ"
        )

    return (
        "üëÅ **–ú–∏–Ω–¥–∞–ª—å–Ω—ã–µ –≥–ª–∞–∑–∞**\n"
        "‚Ä¢ –°–≤–µ—Ç –Ω–∞ –≤–µ–∫–æ\n"
        "‚Ä¢ –¢–µ–Ω—å –≤–æ –≤–Ω–µ—à–Ω–∏–π —É–≥–æ–ª\n"
        "‚Ä¢ –ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∞—è –¥–∏–∞–≥–æ–Ω–∞–ª—å\n"
        "‚Ä¢ –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞"
    )


# ===== Other blocks =====
def lips_line(a: Answers) -> str:
    if a.occasion == "party":
        return "üëÑ –ì—É–±—ã: –Ω—é–¥ –∏–ª–∏ —á—É—Ç—å —è—Ä—á–µ"
    if a.occasion == "date":
        return "üëÑ –ì—É–±—ã: –º—è–≥–∫–∏–π –Ω—é–¥ –∏–ª–∏ –±–ª–µ—Å–∫"
    if a.occasion == "photo":
        return "üëÑ –ì—É–±—ã: –±–µ–∑ —Å–∏–ª—å–Ω–æ–≥–æ –≥–ª—è–Ω—Ü–∞"
    return "üëÑ –ì—É–±—ã: –Ω—é–¥ –ø–æ –ø–æ–¥—Ç–æ–Ω—É"


def mistake(a: Answers) -> str:
    if a.eyes == "small":
        return "—Ç—ë–º–Ω—ã–µ —Ç–µ–Ω–∏ –ø–æ –≤—Å–µ–º—É –≤–µ–∫—É"
    if a.eyes == "hooded":
        return "—á—ë—Ç–∫–∞—è –ª–∏–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∫–µ"
    if a.skin == "dry":
        return "–º–Ω–æ–≥–æ –ø—É–¥—Ä—ã"
    if a.skin == "oily":
        return "–ø–ª–æ—Ç–Ω—ã–π —Ç–æ–Ω"
    return "–ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –º–∞–∫–∏—è–∂"


def formula(a: Answers) -> str:
    if a.eyes == "small":
        return "‚ú® –§–æ—Ä–º—É–ª–∞: —Å–≤–µ—Ç –≤–Ω—É—Ç—Ä–∏ ‚Üí —Ç–µ–Ω—å —Å–Ω–∞—Ä—É–∂–∏"
    if a.eyes == "hooded":
        return "‚ú® –§–æ—Ä–º—É–ª–∞: —Ç–µ–Ω—å –≤—ã—à–µ —Å–∫–ª–∞–¥–∫–∏ ‚Üí —Ä–∞—Å—Ç—É—à—ë–≤–∫–∞ –≤–≤–µ—Ä—Ö"
    return "‚ú® –§–æ—Ä–º—É–ª–∞: –æ–¥–∏–Ω –∞–∫—Ü–µ–Ω—Ç + –ª—ë–≥–∫–∏–µ —Å–ª–æ–∏"


# ===== Build text =====
def build_text(a: Answers, level: DetailLevel = "short") -> str:
    photo_links = image_links_for_set(pick_photo_set(a))

    header = (
        "üíÑ **–¢–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –º–∞–∫–∏—è–∂:**\n\n"
        f"**–ö–æ–∂–∞:** {skin_line(a.skin)}\n"
        f"**–ü–æ–¥—Ç–æ–Ω:** {undertone_line(a.undertone)}\n"
        f"**–ì–ª–∞–∑–∞:** {eyes_short(a.eyes)}\n\n"
        "üì∏ **–ü—Ä–∏–º–µ—Ä—ã:**\n"
        f"{photo_links}\n"
    )

    if level == "short":
        return (
            header +
            "\n**–°—Ö–µ–º–∞ (–∫–æ—Ä–æ—Ç–∫–æ):**\n"
            "1Ô∏è‚É£ –õ—ë–≥–∫–∏–π —Ç–æ–Ω\n"
            "2Ô∏è‚É£ –†—É–º—è–Ω–∞ –≤—ã—à–µ —Å–∫—É–ª—ã\n"
            "3Ô∏è‚É£ –ì–ª–∞–∑–∞: —Å–≤–µ—Ç + —Ç–µ–Ω—å —Å–Ω–∞—Ä—É–∂–∏\n"
            f"{lips_line(a)}\n\n"
            f"‚ùå –û—à–∏–±–∫–∞: {mistake(a)}\n"
            f"{formula(a)}\n\n"
            "‚û°Ô∏è –ù–∞–∂–º–∏ **¬´–ü–æ–¥—Ä–æ–±–Ω–µ–µ¬ª**"
        )

    return (
        header +
        "\n**–ü–æ–¥—Ä–æ–±–Ω–æ:**\n"
        f"{eyes_full(a.eyes)}\n\n"
        f"{lips_line(a)}\n\n"
        f"‚ùå –û—à–∏–±–∫–∞: {mistake(a)}\n"
        f"{formula(a)}"
    )
