from dataclasses import dataclass
from typing import Literal
from .content import image_links_for_set

Skin = Literal["dry","normal","combo","oily","unknown"]
Tone = Literal["light","medium","tan"]
Undertone = Literal["warm","cool","unknown"]
Eyes = Literal["small","big","hooded","almond"]
Occasion = Literal["daily","date","party","photo"]

@dataclass
class Answers:
    skin: Skin
    tone: Tone
    undertone: Undertone
    eyes: Eyes
    occasion: Occasion

def pick_photo_set(a: Answers) -> int:
    # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç: –ø–æ–≤–æ–¥ ‚Üí –≥–ª–∞–∑–∞ ‚Üí –ø–æ–¥—Ç–æ–Ω ‚Üí –∫–æ–∂–∞ ‚Üí –±–∞–∑–æ–≤—ã–π
    if a.occasion == "date":
        return 2
    if a.occasion == "party":
        return 3
    if a.occasion == "photo":
        return 4

    if a.eyes == "hooded":
        return 5
    if a.eyes == "small":
        return 6

    if a.undertone == "warm":
        return 7
    if a.undertone == "cool":
        return 8

    if a.skin in ("oily","combo"):
        return 9
    if a.skin == "dry":
        return 10

    return 1

def skin_line(s: Skin) -> str:
    return {
        "dry": "—Å—É—Ö–∞—è ‚Üí —É–≤–ª–∞–∂–Ω–µ–Ω–∏–µ, –∫—Ä–µ–º–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—É—Ä—ã, –ª—ë–≥–∫–æ–µ —Å–∏—è–Ω–∏–µ",
        "normal": "–Ω–æ—Ä–º–∞–ª—å–Ω–∞—è ‚Üí –ø–æ–¥–æ–π–¥—É—Ç –ø–æ—á—Ç–∏ –≤—Å–µ —Ç–µ–∫—Å—Ç—É—Ä—ã, –ª—É—á—à–µ –ª—ë–≥–∫–∏–µ —Å–ª–æ–∏",
        "combo": "–∫–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω–∞—è ‚Üí –º–∞—Ç–∏—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –¢-–∑–æ–Ω—É, –æ—Å—Ç–∞–ª—å–Ω–æ–µ –æ—Å—Ç–∞–≤–ª—è–µ–º ‚Äú–∂–∏–≤—ã–º‚Äù",
        "oily": "–∂–∏—Ä–Ω–∞—è ‚Üí —Ç–æ–Ω–∫–∏–π –º–∞—Ç–∏—Ä—É—é—â–∏–π —Å–ª–æ–π, —Ñ–∏–∫—Å–∞—Ü–∏—è –≤ –¢-–∑–æ–Ω–µ",
        "unknown": "—Ç–∏–ø –Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω ‚Üí —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–æ: –ª—ë–≥–∫–∏–π —Ç–æ–Ω + —Ç–æ—á–µ—á–Ω–∞—è –∫–æ—Ä—Ä–µ–∫—Ü–∏—è",
    }[s]

def undertone_line(u: Undertone) -> str:
    return {
        "warm": "—Ç—ë–ø–ª—ã–π ‚Üí –ø–µ—Ä—Å–∏–∫–æ–≤—ã–µ, –±–µ–∂–µ–≤—ã–µ, –∑–æ–ª–æ—Ç–∏—Å—Ç—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏",
        "cool": "—Ö–æ–ª–æ–¥–Ω—ã–π ‚Üí —Ä–æ–∑–æ–≤—ã–µ, —è–≥–æ–¥–Ω—ã–µ, —Ö–æ–ª–æ–¥–Ω—ã–µ –±–µ–∂–∏",
        "unknown": "–Ω–µ –æ–ø—Ä–µ–¥–µ–ª—ë–Ω ‚Üí –Ω–µ–π—Ç—Ä–∞–ª—å–Ω—ã–µ –±–µ–∂–µ–≤–æ-—Ä–æ–∑–æ–≤—ã–µ –æ—Ç—Ç–µ–Ω–∫–∏",
    }[u]

def eyes_line(e: Eyes) -> str:
    return {
        "small": "–º–∞–ª–µ–Ω—å–∫–∏–µ ‚Üí –±–æ–ª—å—à–µ —Å–≤–µ—Ç–∞, –∞–∫—Ü–µ–Ω—Ç –≤–æ –≤–Ω–µ—à–Ω–µ–º —É–≥–æ–ª–∫–µ, –Ω–µ –∑–∞—Ç–µ–º–Ω—è–π –≤—Å—ë –≤–µ–∫–æ",
        "big": "–±–æ–ª—å—à–∏–µ ‚Üí –º–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –≥–ª—É–±–∏–Ω—É –º—è–≥–∫–∏–º–∏ –æ—Ç—Ç–µ–Ω–∫–∞–º–∏ –∏ —Ä–∞—Å—Ç—É—à—ë–≤–∫–æ–π",
        "hooded": "–Ω–∞–≤–∏c—à–µ–µ –≤–µ–∫–æ ‚Üí —Ç–µ–Ω–∏ —Ä–∞—Å—Ç—É—à—ë–≤—ã–≤–∞–π –≤—ã—à–µ —Å–∫–ª–∞–¥–∫–∏, –∏–∑–±–µ–≥–∞–π —á—ë—Ç–∫–∏—Ö –ª–∏–Ω–∏–π",
        "almond": "–º–∏–Ω–¥–∞–ª–µ–≤–∏–¥–Ω—ã–µ ‚Üí —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞, –º–æ–∂–Ω–æ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –º—è–≥–∫–æ",
    }[e]

def steps(a: Answers) -> list[str]:
    # –ë–∞–∑–∞ + –Ω–µ–±–æ–ª—å—à–∏–µ –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ –ø–æ–≤–æ–¥/–∫–æ–∂—É
    base = [
        "1Ô∏è‚É£ –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞: —É–≤–ª–∞–∂–Ω–µ–Ω–∏–µ (–¥–ª—è –∂–∏—Ä–Ω–æ–π ‚Äî –ª—ë–≥–∫–∏–π –≥–µ–ª—å)",
        "2Ô∏è‚É£ –õ—ë–≥–∫–∏–π —Ç–æ–Ω + —Ç–æ—á–µ—á–Ω—ã–π –∫–æ–Ω—Å–∏–ª–µ—Ä (–Ω–µ —Å–ª–æ–π –Ω–∞ —Å–ª–æ–π)",
        "3Ô∏è‚É£ –†—É–º—è–Ω–∞ –ø–æ –ø–æ–¥—Ç–æ–Ω—É (–Ω–∞–Ω–æ—Å–∏ —á—É—Ç—å –≤—ã—à–µ —Å–∫—É–ª—ã)",
        "4Ô∏è‚É£ –¢–µ–Ω–∏: –±–∞–∑–æ–≤—ã–π —Å–≤–µ—Ç–ª—ã–π + –º—è–≥–∫–∞—è —Ä–∞—Å—Ç—É—à—ë–≤–∫–∞",
        "5Ô∏è‚É£ –¢—É—à—å: –ø–æ–¥–∫—Ä—É—á–∏–≤–∞–Ω–∏–µ + 1‚Äì2 —Ç–æ–Ω–∫–∏—Ö —Å–ª–æ—è",
        "6Ô∏è‚É£ –ì—É–±—ã: –Ω—é–¥/–±–ª–µ—Å–∫, –∞–∫–∫—É—Ä–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç—É—Ä –ø—Ä–∏ –∂–µ–ª–∞–Ω–∏–∏",
    ]
    if a.occasion == "party":
        base[3] = "4Ô∏è‚É£ –¢–µ–Ω–∏: –±–æ–ª—å—à–µ –≤—ã—Ä–∞–∑–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ (–Ω–æ —Å –º—è–≥–∫–æ–π —Ä–∞—Å—Ç—É—à—ë–≤–∫–æ–π)"
        base[5] = "6Ô∏è‚É£ –ì—É–±—ã: –Ω—é–¥ –∏–ª–∏ —á—É—Ç—å —è—Ä—á–µ (–µ—Å–ª–∏ –≥–ª–∞–∑–∞ —Å–ø–æ–∫–æ–π–Ω—ã–µ)"
    if a.occasion == "date":
        base[2] = "3Ô∏è‚É£ –†—É–º—è–Ω–∞: —Å–≤–µ–∂–∏–π —Ä—É–º—è–Ω–µ—Ü (–Ω–µ –±–æ–π—Å—è, –Ω–æ –±–µ–∑ –ø–µ—Ä–µ–±–æ—Ä–∞)"
        base[5] = "6Ô∏è‚É£ –ì—É–±—ã: –∫–æ–º—Ñ–æ—Ä—Ç–Ω—ã–π –Ω—é–¥/–±–ª–µ—Å–∫ (–º—è–≥–∫–æ –∏ –∂–µ–Ω—Å—Ç–≤–µ–Ω–Ω–æ)"
    if a.occasion == "photo":
        base[1] = "2Ô∏è‚É£ –¢–æ–Ω: —á—É—Ç—å –ø–ª–æ—Ç–Ω–µ–µ –æ–±—ã—á–Ω–æ–≥–æ, –Ω–æ –±–µ–∑ ‚Äú–º–∞—Å–∫–∏‚Äù"
        base[3] = "4Ô∏è‚É£ –¢–µ–Ω–∏: –º–∞—Ç–æ–≤—ã–µ/—Å–∞—Ç–∏–Ω, –±–µ–∑ –∫—Ä—É–ø–Ω–æ–≥–æ –≥–ª–∏—Ç—Ç–µ—Ä–∞"
    return base

def mistake(a: Answers) -> str:
    if a.skin == "dry":
        return "–ø–ª–æ—Ç–Ω—ã–π –º–∞—Ç–æ–≤—ã–π —Ç–æ–Ω –∏ –º–Ω–æ–≥–æ –ø—É–¥—Ä—ã ‚Äî –ø–æ–¥—á—ë—Ä–∫–∏–≤–∞—é—Ç —Å—É—Ö–æ—Å—Ç—å"
    if a.skin == "oily":
        return "–ø–ª–æ—Ç–Ω—ã–π —Ç–æ–Ω —Ç–æ–ª—Å—Ç—ã–º —Å–ª–æ–µ–º ‚Äî –æ–Ω –±—ã—Å—Ç—Ä–µ–µ ‚Äú–ø–æ–ø–ª—ã–≤—ë—Ç‚Äù"
    if a.eyes == "hooded":
        return "—á—ë—Ç–∫–∞—è –ª–∏–Ω–∏—è –ø–æ —Å–∫–ª–∞–¥–∫–µ –≤–µ–∫–∞ ‚Äî –≤–∏–∑—É–∞–ª—å–Ω–æ ‚Äú—Ä–µ–∂–µ—Ç‚Äù –≥–ª–∞–∑"
    if a.eyes == "small":
        return "—Ç—ë–º–Ω—ã–µ —Ç–µ–Ω–∏ –ø–æ –≤—Å–µ–º—É –≤–µ–∫—É ‚Äî —É–º–µ–Ω—å—à–∞—é—Ç –≥–ª–∞–∑–∞"
    if a.occasion == "photo":
        return "–∫—Ä—É–ø–Ω—ã–π –±–ª–µ—Å–∫ –∏ –≥–ª–∏—Ç—Ç–µ—Ä ‚Äî —á–∞—Å—Ç–æ –≤—ã–≥–ª—è–¥–∏—Ç –Ω–µ–∞–∫–∫—É—Ä–∞—Ç–Ω–æ –≤ –∫–∞–¥—Ä–µ"
    return "–ø–µ—Ä–µ–≥—Ä—É–∂–∞—Ç—å –ª–∏—Ü–æ –ª–∏—à–Ω–∏–º–∏ —Å–ª–æ—è–º–∏"

def build_final_text(a: Answers) -> str:
    set_id = pick_photo_set(a)
    photo_links = image_links_for_set(set_id)

    text = (
        "üíÑ **–¢–≤–æ–π –∏–¥–µ–∞–ª—å–Ω—ã–π –º–∞–∫–∏—è–∂ (–ø–ª–∞–Ω):**\n\n"
        f"**–ö–æ–∂–∞:** {skin_line(a.skin)}\n"
        f"**–ü–æ–¥—Ç–æ–Ω:** {undertone_line(a.undertone)}\n"
        f"**–ì–ª–∞–∑–∞:** {eyes_line(a.eyes)}\n\n"
        "üì∏ **–ü—Ä–∏–º–µ—Ä—ã –º–∞–∫–∏—è–∂–∞ (–≤–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ):**\n"
        f"{photo_links}\n\n"
        "**–°—Ö–µ–º–∞ –º–∞–∫–∏—è–∂–∞:**\n" +
        "\n".join(steps(a)) +
        f"\n\n‚ùå **–ß–∞—Å—Ç–∞—è –æ—à–∏–±–∫–∞:** {mistake(a)}"
    )
    return text
